(()=>{"use strict";var e={n:a=>{var r=a&&a.__esModule?()=>a.default:()=>a;return e.d(r,{a:r}),r},d:(a,r)=>{for(var t in r)e.o(r,t)&&!e.o(a,t)&&Object.defineProperty(a,t,{enumerable:!0,get:r[t]})},o:(e,a)=>Object.prototype.hasOwnProperty.call(e,a)};const a=window.React,r=window.wp.element,t=window.wp.domReady;var l=e.n(t);const n=window.wp.data,o=window.wp.i18n,s=window.wp.components,c=window.wp.keyboardShortcuts,g=window.wp.a11y;function i(e,a,r){const t=e.splice(a,1)[0];return e.splice(r,0,t),e}function u({languages:e,selectedLanguage:r,onMoveUp:t,onMoveDown:l,onRemove:n}){const g=!r||e[0]?.locale===r?.locale,i=!r||e[e.length-1]?.locale===r?.locale,u=!r;return(0,c.useShortcut)("preferred-languages/move-up",(e=>{e.preventDefault(),g||t()})),(0,c.useShortcut)("preferred-languages/move-down",(e=>{e.preventDefault(),i||l()})),(0,c.useShortcut)("preferred-languages/remove",(e=>{e.preventDefault(),u||n()})),(0,a.createElement)("div",{className:"active-locales-controls"},(0,a.createElement)("ul",null,(0,a.createElement)("li",null,(0,a.createElement)(s.Button,{variant:"secondary",showTooltip:!0,"aria-keyshortcuts":"ArrowUp","aria-label":(0,o.sprintf)(/* translators: accessibility text */
(0,o.__)("Move up (%s)","preferred-languages"),/* translators: keyboard shortcut (Arrow Up) */
(0,o.__)("Up","preferred-languages")),label:/* translators: keyboard shortcut (Arrow Up) */
(0,o.__)("Up","preferred-languages"),disabled:g,onClick:t},(0,o.__)("Move Up","preferred-languages"))),(0,a.createElement)("li",null,(0,a.createElement)(s.Button,{variant:"secondary",showTooltip:!0,"aria-keyshortcuts":"ArrowDown","aria-label":(0,o.sprintf)(/* translators: accessibility text */
(0,o.__)("Move down (%s)","preferred-languages"),/* translators: keyboard shortcut (Arrow Down) */
(0,o.__)("Down","preferred-languages")),label:/* translators: keyboard shortcut (Arrow Down) */
(0,o.__)("Down","preferred-languages"),disabled:i,onClick:l},(0,o.__)("Move Down","preferred-languages"))),(0,a.createElement)("li",null,(0,a.createElement)(s.Button,{variant:"secondary",showTooltip:!0,"aria-keyshortcuts":"Delete","aria-label":(0,o.sprintf)(/* translators: accessibility text */
(0,o.__)("Remove from list (%s)","preferred-languages"),/* translators: keyboard shortcut (Delete / Backspace) */
(0,o.__)("Delete","preferred-languages")),label:/* translators: keyboard shortcut (Delete / Backspace) */
(0,o.__)("Delete","preferred-languages"),disabled:u,onClick:n},(0,o.__)("Remove","preferred-languages")))))}const d=function({languages:e,setLanguages:t,showOptionSiteDefault:l=!1,selectedLanguage:n,setSelectedLanguage:s}){const d=(0,r.useRef)(),p=0===e.length;(0,r.useLayoutEffect)((()=>{const e=d.current.querySelector('[aria-selected="true"]');e&&e.scrollIntoView({behavior:"smooth",block:"nearest"})}),[n,e]),(0,c.useShortcut)("preferred-languages/select-first",(a=>{a.preventDefault(),p||s(e.at(0))})),(0,c.useShortcut)("preferred-languages/select-last",(a=>{a.preventDefault(),p||s(e.at(-1))}));const f=p?"":n.locale,m=p?"active-locales-list empty-list":"active-locales-list";let v=(0,o.sprintf)(/* translators: %s: English (United States) */
(0,o.__)("Falling back to %s.","preferred-languages"),"English (United States)");return l&&(v=(0,o.__)("Falling back to Site Default.","preferred-languages")),(0,a.createElement)("div",{className:"active-locales wp-clearfix"},p&&(0,a.createElement)("div",{className:"active-locales-empty-message"},(0,o.__)("Nothing set.","preferred-languages"),(0,a.createElement)("br",null),v),(0,a.createElement)("ul",{role:"listbox","aria-labelledby":"preferred-languages-label",tabIndex:0,"aria-activedescendant":f,className:m,ref:d},e.map((e=>{const{locale:r,nativeName:t,lang:l}=e;return(0,a.createElement)("li",{key:r,role:"option","aria-selected":r===n?.locale,id:r,lang:l,className:"active-locale",onClick:()=>s(e)},t)}))),(0,a.createElement)(u,{languages:e,selectedLanguage:n,onMoveUp:()=>{t((e=>{const a=e.findIndex((({locale:e})=>e===n.locale));return i(Array.from(e),a,a-1)})),(0,g.speak)((0,o.__)("Locale moved up","preferred-languages"))},onMoveDown:()=>{t((e=>{const a=e.findIndex((({locale:e})=>e===n.locale));return i(Array.from(e),a,a+1)})),(0,g.speak)((0,o.__)("Locale moved down","preferred-languages"))},onRemove:()=>{const a=e.findIndex((({locale:e})=>e===n.locale));if(s(e[a+1]||e[a-1]),t((e=>e.filter((({locale:e})=>e!==n.locale)))),(0,g.speak)((0,o.__)("Locale removed from list","preferred-languages")),1===e.length){let e=(0,o.sprintf)(/* translators: %s: English (United States) */
(0,o.__)("No languages selected. Falling back to %s.","preferred-languages"),"English (United States)");l&&(e=(0,o.__)("No languages selected. Falling back to Site Default.","preferred-languages")),(0,g.speak)(e)}}}))},p=window.wp.keycodes;function f({installedLanguages:e,availableLanguages:r,value:t,onChange:l}){const n=e.length||r.length;return(0,a.createElement)(s.SelectControl,{"aria-label":(0,o.__)("Inactive Locales","preferred-languages"),label:(0,o.__)("Inactive Locales","preferred-languages"),hideLabelFromVision:!0,value:t,onChange:l,disabled:!n,__nextHasNoMarginBottom:!0},e.length>0&&(0,a.createElement)("optgroup",{label:(0,o._x)("Installed","translations","preferred-languages")},e.map((({locale:e,lang:r,nativeName:t})=>(0,a.createElement)("option",{key:e,value:e,lang:r},t)))),r.length>0&&(0,a.createElement)("optgroup",{label:(0,o._x)("Available","translations","preferred-languages")},r.map((({locale:e,lang:r,nativeName:t})=>(0,a.createElement)("option",{key:e,value:e,lang:r},t)))))}function m({disabled:e,onClick:r}){return(0,c.useShortcut)("preferred-languages/add",(a=>{a.preventDefault(),e||r()})),(0,a.createElement)("div",{className:"inactive-locales-controls"},(0,a.createElement)(s.Button,{variant:"secondary",showTooltip:!0,"aria-keyshortcuts":"Alt+A","aria-label":(0,o.sprintf)(/* translators: accessibility text. %s: keyboard shortcut. */
(0,o._x)("Add to list (%s)","language","preferred-languages"),p.shortcutAriaLabel.alt("A")),label:p.displayShortcut.alt("A"),disabled:e,onClick:r},(0,o._x)("Add","language","preferred-languages")))}const v=function({languages:e,onAddLanguage:t}){const[l,n]=(0,r.useState)(e[0]);(0,r.useEffect)((()=>{l||n(e[0])}),[l,e]);const s=e.filter((({installed:e})=>Boolean(e))),c=e.filter((({installed:e})=>!e));return(0,a.createElement)("div",{className:"inactive-locales wp-clearfix"},(0,a.createElement)("div",{className:"inactive-locales-list"},(0,a.createElement)(f,{installedLanguages:s,availableLanguages:c,value:l?.locale,onChange:a=>{n(e.find((e=>a===e.locale)))}})),(0,a.createElement)(m,{onClick:()=>{t(l);const e=s.findIndex((({locale:e})=>e===l.locale)),a=c.findIndex((({locale:e})=>e===l.locale));let r;r=s[e+1],r||s[0]===l||(r=s[0]),r||(r=c[a+1],c[0]!==l&&(r=c[0])),n(r),(0,g.speak)((0,o.__)("Locale added to list","preferred-languages"))},disabled:!l}))};function _(){return(0,a.createElement)(s.Notice,{status:"warning",isDismissible:!1},(0,o.__)("Some of the languages are not installed. Re-save changes to download translations.","preferred-languages"))}function w({preferredLanguages:e}){const r=e.filter((e=>Boolean(e))).map((({locale:e})=>e)).join(",");return(0,a.createElement)("input",{type:"hidden",name:"preferred_languages",value:r})}const h=function(e){const{allLanguages:t,hasMissingTranslations:l=!1,showOptionSiteDefault:s=!1}=e,{registerShortcut:g}=(0,n.useDispatch)(c.store);(0,r.useEffect)((()=>{g({name:"preferred-languages/move-up",category:"global",description:(0,o.__)("Move language up","preferred-languages"),keyCombination:{character:"ArrowUp"}}),g({name:"preferred-languages/move-down",category:"global",description:(0,o.__)("Move language down","preferred-languages"),keyCombination:{character:"ArrowDown"}}),g({name:"preferred-languages/select-first",category:"global",description:(0,o.__)("Select first language","preferred-languages"),keyCombination:{character:"Home"}}),g({name:"preferred-languages/select-last",category:"global",description:(0,o.__)("Select last language","preferred-languages"),keyCombination:{character:"End"}}),g({name:"preferred-languages/remove",category:"global",description:(0,o.__)("Remove from list","preferred-languages"),keyCombination:{character:"Backspace"}}),g({name:"preferred-languages/add",category:"global",description:(0,o._x)("Add to list","language","preferred-languages"),keyCombination:{modifier:"alt",character:"a"}})}));const[i,u]=(0,r.useState)(e.preferredLanguages),[p,f]=(0,r.useState)(e.preferredLanguages[0]),m=t.filter((e=>!i.find((({locale:a})=>a===e.locale)))),h=i.some((({installed:e})=>!e));return(0,r.useEffect)((()=>{if(!h)return;const e=()=>{const e=document.createElement("span");e.className="spinner language-install-spinner is-active preferred-languages-spinner";const a=document.querySelector("#submit");a&&a.after(e)},a=document.querySelector("form");return a?(a.addEventListener("submit",e),()=>{a.removeEventListener("submit",e)}):void 0}),[h]),(0,a.createElement)(c.ShortcutProvider,null,(0,a.createElement)("div",{className:"preferred-languages"},(0,a.createElement)(w,{preferredLanguages:i}),(0,a.createElement)("p",null,(0,o.__)("Choose languages for displaying WordPress in, in order of preference.","preferred-languages")),(0,a.createElement)(d,{languages:i,setLanguages:u,showOptionSiteDefault:s,selectedLanguage:p,setSelectedLanguage:f}),(0,a.createElement)(v,{languages:m,onAddLanguage:e=>{u((a=>[...a,e])),f(e)}}),l&&(0,a.createElement)(_,null)))};l()((()=>{const e=window.PreferredLanguages;if(!e.allLanguages.length)return document.querySelector(".site-preferred-languages-wrap").remove(),void document.querySelector(".network-preferred-languages-wrap").remove();const t=document.querySelector("#preferred-languages-root");document.querySelector(".user-language-wrap")?.replaceWith(t.parentElement.parentElement),document.querySelector(".options-general-php #WPLANG")?.parentElement?.parentElement?.replaceWith(t.parentElement.parentElement),document.querySelector(".network-admin.settings-php #WPLANG")?.parentElement?.parentElement?.replaceWith(t.parentElement.parentElement),(0,r.render)((0,a.createElement)(h,{...e}),t)}))})();